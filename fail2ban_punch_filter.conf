# fail2ban filter for Punch Rendezvous Server (QUIC/TCP on port 51820)
# Detects persistent connection attempts and suspicious patterns

[Definition]

# Fail regex - matches connection errors logged by the server
# Format: [FAIL2BAN] Connection attempt failed from IP: <IP>
# Also matches: [SECURITY] Incoming connection error from <IP>: ...
# <HOST> is a fail2ban placeholder that matches IP addresses (IPv4 and IPv6)
failregex = ^.*\[FAIL2BAN\] Connection attempt failed from IP: <HOST>$
            ^.*\[SECURITY\] Incoming connection error from <HOST>:

# Ignore regex - legitimate connections (optional, for future use)
ignoreregex =

# IPv6 support
allowipv6 = auto

# No date pattern - logs may not have timestamps or use systemd format
# fail2ban will match lines regardless of timestamp format
